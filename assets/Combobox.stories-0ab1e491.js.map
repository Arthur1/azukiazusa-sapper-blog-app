{"version":3,"file":"Combobox.stories-0ab1e491.js","sources":["../../src/components/Combobox/DropDownItem.svelte","../../src/components/Icons/Loading.svelte","../../src/components/Combobox/DropDownMenu.svelte","../../src/components/Combobox/Input.svelte","../../src/components/Combobox/Combobox.svelte"],"sourcesContent":["<script lang=\"ts\">\n  export let imageUrl: string\n  export let text: string\n  export let selected: boolean\n  export let id: string\n</script>\n\n<li\n  role=\"option\"\n  aria-selected={selected}\n  {id}\n  class={`cursor-pointer flex items-center px-4 py-3 -mx-2 transition-colors duration-200 transform border-b last:border-0 hover:bg-gray-100 dark:hover:bg-gray-500 dark:border-gray-600 ${\n    selected ? 'bg-gray-100 dark:bg-gray-500' : ''\n  }`}\n  on:mousedown\n>\n  <img class=\"object-cover w-8 h-8 mx-1 rounded-full\" src={imageUrl} alt=\"\" />\n  <p class=\"mx-2 text-sm text-gray-600 dark:text-gray-50\">\n    {text}\n  </p>\n</li>\n","<svg\n  class=\"inline\"\n  version=\"1.1\"\n  id=\"loader-1\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n  x=\"0px\"\n  y=\"0px\"\n  width=\"40px\"\n  height=\"40px\"\n  viewBox=\"0 0 50 50\"\n  style=\"enable-background:new 0 0 50 50;\"\n  xml:space=\"preserve\"\n>\n  <path\n    fill=\"currentColor\"\n    d=\"M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z\"\n  >\n    <animateTransform\n      attributeType=\"xml\"\n      attributeName=\"transform\"\n      type=\"rotate\"\n      from=\"0 25 25\"\n      to=\"360 25 25\"\n      dur=\"0.6s\"\n      repeatCount=\"indefinite\"\n    />\n  </path>\n</svg>\n","<script lang=\"ts\">\n  import DropDownItem from './DropDownItem.svelte'\n  import Loading from '../Icons/Loading.svelte'\n  import type { Item } from './types'\n  import { createEventDispatcher } from 'svelte'\n  const dispatch = createEventDispatcher<{\n    select: Item\n  }>()\n\n  export let items: Item[]\n  export let loading = false\n  export let listboxId: string\n  export let optionId: string\n  export let activeIndex: number | null = null\n</script>\n\n<div\n  on:keydown\n  class=\"absolute z-20 overflow-hidden bg-white rounded-br-md rounded-bl-md shadow-lg w-72 max-h-60 overflow-y-scroll dark:bg-gray-700 border-2 border-t-0 border-gray-300 dark:border-gray-600\"\n>\n  {#if loading}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <div class=\"sr-only\">検索中</div>\n      <Loading />\n    </div>\n  {:else if items.length === 0}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <p class=\"text-gray-500 dark:text-gray-300\">検索結果がありません</p>\n    </div>\n  {:else}\n    <ul class=\"py-2\" role=\"listbox\" aria-label=\"検索結果\" id={listboxId}>\n      {#each items as item, index (item.key)}\n        <DropDownItem\n          imageUrl={item.imageUrl}\n          text={item.text}\n          selected={index === activeIndex}\n          id={`${optionId}-${index}`}\n          on:mousedown={() => {\n            dispatch('select', item)\n          }}\n        />\n      {/each}\n    </ul>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import SearchIcon from '../Icons/Search.svelte'\n  export let value = ''\n  export let placeholder = ''\n  export let name = ''\n  export let isOpen = false\n  export let inputId = ''\n  export let listboxId = ''\n\n  export const focus = () => {\n    input.focus()\n  }\n\n  let input: HTMLInputElement\n</script>\n\n<div class=\"flex border-2 border-gray-300 dark:border-gray-600 rounded-lg w-full\">\n  <input\n    bind:value\n    bind:this={input}\n    on:focus\n    on:blur\n    on:keydown\n    on:input\n    class=\"bg-white h-10 px-5 rounded-l-lg focus:outline-none dark:bg-gray-800 w-60\"\n    type=\"text\"\n    id={inputId}\n    {name}\n    {placeholder}\n    role=\"combobox\"\n    aria-autocomplete=\"both\"\n    aria-expanded={isOpen}\n    aria-controls={listboxId}\n  />\n  <button class=\"flex justify-end p-2 rounded-r-lg dark:bg-gray-700\" aria-label=\"検索\">\n    <SearchIcon className=\"text-gray-600 dark:text-gray-50 h-6 w-6\" />\n  </button>\n</div>\n","<script lang=\"ts\">\n  import DropDownMenu from './DropDownMenu.svelte'\n  import Input from './Input.svelte'\n  import type { Item } from './types'\n  import { createEventDispatcher } from 'svelte'\n  const dispatch = createEventDispatcher<{\n    select: Item\n  }>()\n\n  export let value = ''\n  export let loading = false\n  export let items: Item[] = []\n\n  let inputElement: { focus: () => void }\n  let activeIndex: number | null = null\n  let isOpen = false\n\n  const inputId = 'combobox'\n  const listboxId = 'listbox'\n  const optionId = 'option'\n\n  $: itemCount = items.length\n  $: {\n    if (!isOpen) {\n      activeIndex = null\n    }\n  }\n\n  const handleInput = () => {\n    if (!value.trim()) {\n      isOpen = false\n    } else {\n      isOpen = true\n    }\n  }\n\n  const handleFocus = () => {\n    if (value.trim()) {\n      isOpen = true\n    }\n  }\n\n  const handleBlur = () => {\n    isOpen = false\n  }\n\n  const handleSelect = (e: CustomEvent<Item>) => {\n    value = e.detail.text\n    dispatch('select', e.detail)\n  }\n\n  const navigateList = (e: KeyboardEvent) => {\n    if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      if (activeIndex === null) {\n        isOpen = true\n        activeIndex = 0\n      } else if (activeIndex < itemCount - 1) {\n        activeIndex++\n      } else {\n        activeIndex = 0\n      }\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      if (activeIndex === null) {\n        isOpen = true\n        activeIndex = 0\n      } else if (activeIndex > 0) {\n        activeIndex--\n      } else {\n        activeIndex = itemCount - 1\n      }\n    } else if (e.key === 'Enter') {\n      isOpen = false\n      if (activeIndex !== null) {\n        e.preventDefault()\n        handleSelect({ detail: items[activeIndex] } as CustomEvent<Item>)\n        activeIndex = null\n      }\n    } else if (e.key === 'Escape') {\n      e.preventDefault()\n      inputElement.focus()\n\n      if (isOpen) {\n        isOpen = false\n        activeIndex = null\n      } else {\n        value = ''\n      }\n    }\n  }\n</script>\n\n<Input\n  bind:this={inputElement}\n  bind:value\n  on:focus={handleFocus}\n  on:blur={handleBlur}\n  on:keydown={navigateList}\n  on:input={handleInput}\n  {inputId}\n  {listboxId}\n  placeholder=\"Search\"\n/>\n{#if isOpen}\n  <DropDownMenu {items} {loading} {listboxId} {optionId} {activeIndex} on:select={handleSelect} />\n{/if}\n"],"names":["ctx","attr","img","img_src_value","insert_hydration","target","li","anchor","append_hydration","p","imageUrl","$$props","text","selected","id","svg","path","animateTransform","get_key","__name","i","ul","div","div1","div0","dirty","dropdownitem_changes","dispatch","createEventDispatcher","items","loading","listboxId","optionId","activeIndex","item","input_1","button","value","placeholder","name","isOpen","inputId","focus","input","$$value","create_if_block","inputElement","handleInput","$$invalidate","handleFocus","handleBlur","handleSelect","e","navigateList","itemCount"],"mappings":"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"}