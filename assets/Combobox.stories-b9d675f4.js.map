{"version":3,"file":"Combobox.stories-b9d675f4.js","sources":["../../src/components/Combobox/DropDownItem.svelte","../../src/components/Icons/Loading.svelte","../../src/components/Combobox/DropDownMenu.svelte","../../src/components/Combobox/Input.svelte","../../src/components/Combobox/Combobox.svelte","../../src/components/Combobox/Combobox.stories.ts"],"sourcesContent":["<script lang=\"ts\">\n  export let imageUrl: string\n  export let text: string\n  export let selected: boolean\n  export let id: string\n</script>\n\n<li\n  role=\"option\"\n  aria-selected={selected}\n  {id}\n  class={`cursor-pointer flex items-center px-4 py-3 -mx-2 transition-colors duration-200 transform border-b last:border-0 hover:bg-gray-100 dark:hover:bg-gray-500 dark:border-gray-600 ${\n    selected ? 'bg-gray-100 dark:bg-gray-500' : ''\n  }`}\n  on:mousedown\n>\n  <img class=\"object-cover w-8 h-8 mx-1 rounded-full\" src={imageUrl} alt=\"\" />\n  <p class=\"mx-2 text-sm text-gray-600 dark:text-gray-50\">\n    {text}\n  </p>\n</li>\n","<svg\n  class=\"inline\"\n  version=\"1.1\"\n  id=\"loader-1\"\n  xmlns=\"http://www.w3.org/2000/svg\"\n  xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n  x=\"0px\"\n  y=\"0px\"\n  width=\"40px\"\n  height=\"40px\"\n  viewBox=\"0 0 50 50\"\n  style=\"enable-background:new 0 0 50 50;\"\n  xml:space=\"preserve\"\n>\n  <path\n    fill=\"currentColor\"\n    d=\"M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z\"\n  >\n    <animateTransform\n      attributeType=\"xml\"\n      attributeName=\"transform\"\n      type=\"rotate\"\n      from=\"0 25 25\"\n      to=\"360 25 25\"\n      dur=\"0.6s\"\n      repeatCount=\"indefinite\"\n    />\n  </path>\n</svg>\n","<script lang=\"ts\">\n  import DropDownItem from './DropDownItem.svelte'\n  import Loading from '../Icons/Loading.svelte'\n  import type { Item } from './types'\n  import { createEventDispatcher } from 'svelte'\n  const dispatch = createEventDispatcher<{\n    select: Item\n  }>()\n\n  export let items: Item[]\n  export let loading = false\n  export let listboxId: string\n  export let optionId: string\n  export let activeIndex: number | null = null\n</script>\n\n<div\n  on:keydown\n  class=\"absolute z-20 overflow-hidden bg-white rounded-br-md rounded-bl-md shadow-lg w-72 max-h-60 overflow-y-scroll dark:bg-gray-700 border-2 border-t-0 border-gray-300 dark:border-gray-600\"\n>\n  {#if loading}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <div class=\"sr-only\">検索中</div>\n      <Loading />\n    </div>\n  {:else if items.length === 0}\n    <div class=\"py-2 text-center\" aria-live=\"polite\" aria-atomic=\"true\">\n      <p class=\"text-gray-500 dark:text-gray-300\">検索結果がありません</p>\n    </div>\n  {:else}\n    <ul class=\"py-2\" role=\"listbox\" aria-label=\"検索結果\" id={listboxId}>\n      {#each items as item, index (item.key)}\n        <DropDownItem\n          imageUrl={item.imageUrl}\n          text={item.text}\n          selected={index === activeIndex}\n          id={`${optionId}-${index}`}\n          on:mousedown={() => {\n            dispatch('select', item)\n          }}\n        />\n      {/each}\n    </ul>\n  {/if}\n</div>\n","<script lang=\"ts\">\n  import SearchIcon from '../Icons/Search.svelte'\n  export let value = ''\n  export let placeholder = ''\n  export let name = ''\n  export let isOpen = false\n  export let inputId = ''\n  export let listboxId = ''\n\n  export const focus = () => {\n    input.focus()\n  }\n\n  let input: HTMLInputElement\n</script>\n\n<div class=\"flex border-2 border-gray-300 dark:border-gray-600 rounded-lg w-full\">\n  <input\n    bind:value\n    bind:this={input}\n    on:focus\n    on:blur\n    on:keydown\n    on:input\n    class=\"bg-white h-10 px-5 rounded-l-lg focus:outline-none dark:bg-gray-800 w-60\"\n    type=\"text\"\n    id={inputId}\n    {name}\n    {placeholder}\n    role=\"combobox\"\n    aria-autocomplete=\"both\"\n    aria-expanded={isOpen}\n    aria-controls={listboxId}\n  />\n  <button class=\"flex justify-end p-2 rounded-r-lg dark:bg-gray-700\" aria-label=\"検索\">\n    <SearchIcon className=\"text-gray-600 dark:text-gray-50 h-6 w-6\" />\n  </button>\n</div>\n","<script lang=\"ts\">\n  import DropDownMenu from './DropDownMenu.svelte'\n  import Input from './Input.svelte'\n  import type { Item } from './types'\n  import { createEventDispatcher } from 'svelte'\n  const dispatch = createEventDispatcher<{\n    select: Item\n  }>()\n\n  export let value = ''\n  export let loading = false\n  export let items: Item[] = []\n\n  let inputElement: { focus: () => void }\n  let activeIndex: number | null = null\n  let isOpen = false\n\n  const inputId = 'combobox'\n  const listboxId = 'listbox'\n  const optionId = 'option'\n\n  $: itemCount = items.length\n  $: {\n    if (!isOpen) {\n      activeIndex = null\n    }\n  }\n\n  const handleInput = () => {\n    if (!value.trim()) {\n      isOpen = false\n    } else {\n      isOpen = true\n    }\n  }\n\n  const handleFocus = () => {\n    if (value.trim()) {\n      isOpen = true\n    }\n  }\n\n  const handleBlur = () => {\n    isOpen = false\n  }\n\n  const handleSelect = (e: CustomEvent<Item>) => {\n    value = e.detail.text\n    dispatch('select', e.detail)\n  }\n\n  const navigateList = (e: KeyboardEvent) => {\n    if (e.key === 'ArrowDown') {\n      e.preventDefault()\n      if (activeIndex === null) {\n        isOpen = true\n        activeIndex = 0\n      } else if (activeIndex < itemCount - 1) {\n        activeIndex++\n      } else {\n        activeIndex = 0\n      }\n    } else if (e.key === 'ArrowUp') {\n      e.preventDefault()\n      if (activeIndex === null) {\n        isOpen = true\n        activeIndex = 0\n      } else if (activeIndex > 0) {\n        activeIndex--\n      } else {\n        activeIndex = itemCount - 1\n      }\n    } else if (e.key === 'Enter') {\n      isOpen = false\n      if (activeIndex !== null) {\n        e.preventDefault()\n        handleSelect({ detail: items[activeIndex] } as CustomEvent<Item>)\n        activeIndex = null\n      }\n    } else if (e.key === 'Escape') {\n      e.preventDefault()\n      inputElement.focus()\n\n      if (isOpen) {\n        isOpen = false\n        activeIndex = null\n      } else {\n        value = ''\n      }\n    }\n  }\n</script>\n\n<Input\n  bind:this={inputElement}\n  bind:value\n  on:focus={handleFocus}\n  on:blur={handleBlur}\n  on:keydown={navigateList}\n  on:input={handleInput}\n  {inputId}\n  {listboxId}\n  placeholder=\"Search\"\n/>\n{#if isOpen}\n  <DropDownMenu {items} {loading} {listboxId} {optionId} {activeIndex} on:select={handleSelect} />\n{/if}\n","import type { Meta, StoryObj } from '@storybook/svelte';\nimport Combobox from './Combobox.svelte';\nimport type { Item } from './types';\nconst meta = ({\n  title: 'Combobox',\n  component: Combobox,\n  tags: ['autodocs'],\n  argTypes: {\n    items: {\n      control: {\n        type: 'object'\n      },\n      describe: '選択肢の配列。各要素は { imageUrl: string, text: string, key: string } の形式である必要がある。'\n    },\n    loading: {\n      control: {\n        type: 'boolean'\n      },\n      describe: 'ローディング中かどうか'\n    },\n    value: {\n      control: {\n        type: 'text'\n      },\n      describe: '入力されている値'\n    }\n  }\n} satisfies Meta<Combobox>);\nexport default meta;\ntype Story = StoryObj<Combobox>;\nconst items: Item[] = [{\n  imageUrl: 'https://placehold.jp/24/cccccc/ffffff/150x150.png?text=1',\n  text: 'Item 1',\n  key: '1'\n}, {\n  imageUrl: 'https://placehold.jp/24/cccccc/ffffff/150x150.png?text=2',\n  text: 'Item 2',\n  key: '2'\n}, {\n  imageUrl: 'https://placehold.jp/24/cccccc/ffffff/150x150.png?text=3',\n  text: 'Item 3',\n  key: '3'\n}, {\n  imageUrl: 'https://placehold.jp/24/cccccc/ffffff/150x150.png?text=4',\n  text: 'Item 4',\n  key: '4'\n}, {\n  imageUrl: 'https://placehold.jp/24/cccccc/ffffff/150x150.png?text=5',\n  text: 'Item 5',\n  key: '5'\n}];\nexport const Default: Story = {\n  args: {\n    items,\n    loading: false,\n    value: ''\n  }\n};\nexport const Loading: Story = {\n  args: {\n    items,\n    value: 'hoge',\n    loading: true\n  }\n};\nexport const noResults: Story = {\n  args: {\n    items: [],\n    loading: false,\n    value: 'hoge'\n  }\n};\nDefault.parameters = {\n  ...Default.parameters,\n  docs: {\n    ...Default.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  args: {\\n    items,\\n    loading: false,\\n    value: ''\\n  }\\n}\",\n      ...Default.parameters?.docs?.source\n    }\n  }\n};\nLoading.parameters = {\n  ...Loading.parameters,\n  docs: {\n    ...Loading.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  args: {\\n    items,\\n    value: 'hoge',\\n    loading: true\\n  }\\n}\",\n      ...Loading.parameters?.docs?.source\n    }\n  }\n};\nnoResults.parameters = {\n  ...noResults.parameters,\n  docs: {\n    ...noResults.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  args: {\\n    items: [],\\n    loading: false,\\n    value: 'hoge'\\n  }\\n}\",\n      ...noResults.parameters?.docs?.source\n    }\n  }\n};"],"names":["ctx","attr","img","img_src_value","insert_hydration","target","li","anchor","append_hydration","p","imageUrl","$$props","text","selected","id","svg","path","animateTransform","get_key","i","ul","div","div1","div0","dirty","dropdownitem_changes","dispatch","createEventDispatcher","items","loading","listboxId","optionId","activeIndex","item","input_1","button","value","placeholder","name","isOpen","inputId","focus","input","$$value","create_if_block","inputElement","handleInput","$$invalidate","handleFocus","handleBlur","handleSelect","e","navigateList","itemCount","meta","Combobox","Default","Loading","noResults","_a","_c","_b"],"mappings":"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"}